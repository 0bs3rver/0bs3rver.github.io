<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>linux-pwn技能树 | 0bs3rver的小屋</title><meta name="description" content="linux-pwn技能树"><meta name="keywords" content="pwn"><meta name="author" content="0bs3rver"><meta name="copyright" content="0bs3rver"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="https://space.0bs3rver.workers.dev/0bs3rver/Picture/master//blogimg/坂本先生.jpeg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="linux-pwn技能树"><meta name="twitter:description" content="linux-pwn技能树"><meta name="twitter:image" content="http://yoursite.com/img/post.jpg"><meta property="og:type" content="article"><meta property="og:title" content="linux-pwn技能树"><meta property="og:url" content="http://yoursite.com/2020/12/03/linux-pwn%E6%8A%80%E8%83%BD%E6%A0%91/"><meta property="og:site_name" content="0bs3rver的小屋"><meta property="og:description" content="linux-pwn技能树"><meta property="og:image" content="http://yoursite.com/img/post.jpg"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://yoursite.com/2020/12/03/linux-pwn%E6%8A%80%E8%83%BD%E6%A0%91/"><link rel="prev" title="pwnable.tw-babystack-strcpy形成栈溢出" href="http://yoursite.com/2020/12/04/pwnable-tw-babystack-strcpy%E5%BD%A2%E6%88%90%E6%A0%88%E6%BA%A2%E5%87%BA/"><link rel="next" title="pwnable.tw-spirited_away-read与sprintf的栈溢出" href="http://yoursite.com/2020/12/02/pwnable-tw-spirited-away-read%E4%B8%8Esprintf%E7%9A%84%E6%A0%88%E6%BA%A2%E5%87%BA/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://space.0bs3rver.workers.dev/0bs3rver/Picture/master//blogimg/坂本先生.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">41</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">19</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#保护机制"><span class="toc-number">1.</span> <span class="toc-text">保护机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#canary保护"><span class="toc-number">1.1.</span> <span class="toc-text">canary保护</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#泄漏栈中的canary"><span class="toc-number">1.1.1.</span> <span class="toc-text">泄漏栈中的canary</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#绕过canary"><span class="toc-number">1.1.2.</span> <span class="toc-text">绕过canary</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#one-by-one-爆破-Canary"><span class="toc-number">1.1.3.</span> <span class="toc-text">one-by-one 爆破 Canary</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#劫持-stack-chk-fail-函数"><span class="toc-number">1.1.4.</span> <span class="toc-text">劫持__stack_chk_fail 函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#覆盖-TLS-中储存的-Canary-值"><span class="toc-number">1.1.5.</span> <span class="toc-text">覆盖 TLS 中储存的 Canary 值</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#栈溢出"><span class="toc-number">2.</span> <span class="toc-text">栈溢出</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#初级ROP"><span class="toc-number">2.1.</span> <span class="toc-text">初级ROP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ret2text"><span class="toc-number">2.1.1.</span> <span class="toc-text">ret2text</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ret2shellcode"><span class="toc-number">2.1.2.</span> <span class="toc-text">ret2shellcode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ret2syscall"><span class="toc-number">2.1.3.</span> <span class="toc-text">ret2syscall</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ret2libc"><span class="toc-number">2.1.4.</span> <span class="toc-text">ret2libc</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#中级ROP"><span class="toc-number">2.2.</span> <span class="toc-text">中级ROP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ret2csu"><span class="toc-number">2.2.1.</span> <span class="toc-text">ret2csu</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ret2reg"><span class="toc-number">2.2.2.</span> <span class="toc-text">ret2reg</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BROP"><span class="toc-number">2.2.3.</span> <span class="toc-text">BROP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#高级ROP"><span class="toc-number">2.3.</span> <span class="toc-text">高级ROP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ret2-dl-runtime-resolve"><span class="toc-number">2.3.1.</span> <span class="toc-text">ret2_dl_runtime_resolve</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SROP"><span class="toc-number">2.3.2.</span> <span class="toc-text">SROP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Stack-smash"><span class="toc-number">2.4.</span> <span class="toc-text">Stack smash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#栈上的-partial-overwrite"><span class="toc-number">2.5.</span> <span class="toc-text">栈上的 partial overwrite</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#栈迁移"><span class="toc-number">2.6.</span> <span class="toc-text">栈迁移</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#格式化字符串"><span class="toc-number">3.</span> <span class="toc-text">格式化字符串</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#printf"><span class="toc-number">3.1.</span> <span class="toc-text">printf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sprintf"><span class="toc-number">3.2.</span> <span class="toc-text">sprintf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#strcpy"><span class="toc-number">3.3.</span> <span class="toc-text">strcpy</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#堆利用"><span class="toc-number">4.</span> <span class="toc-text">堆利用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#off-by-one"><span class="toc-number">4.1.</span> <span class="toc-text">off-by-one</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#chunk-extend"><span class="toc-number">4.2.</span> <span class="toc-text">chunk extend</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unlink"><span class="toc-number">4.3.</span> <span class="toc-text">unlink</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UAF"><span class="toc-number">4.4.</span> <span class="toc-text">UAF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fastbin-attack"><span class="toc-number">4.5.</span> <span class="toc-text">fastbin-attack</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#house-of-spirit"><span class="toc-number">4.5.1.</span> <span class="toc-text">house-of-spirit</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#arbitrary-alloc"><span class="toc-number">4.5.2.</span> <span class="toc-text">arbitrary-alloc</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unsortedbin-attack"><span class="toc-number">4.6.</span> <span class="toc-text">unsortedbin-attack</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#main-arena泄漏libc基址"><span class="toc-number">4.6.1.</span> <span class="toc-text">main-arena泄漏libc基址</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tcache-attack"><span class="toc-number">4.7.</span> <span class="toc-text">tcache-attack</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#tcache-dup"><span class="toc-number">4.7.1.</span> <span class="toc-text">tcache-dup</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#glibc2-29-key指针"><span class="toc-number">4.8.</span> <span class="toc-text">glibc2.29-key指针</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IO-FILE"><span class="toc-number">5.</span> <span class="toc-text">IO FILE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#glibc2-23下伪造vtable"><span class="toc-number">5.1.</span> <span class="toc-text">glibc2.23下伪造vtable</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#逻辑漏洞"><span class="toc-number">6.</span> <span class="toc-text">逻辑漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#整数溢出"><span class="toc-number">7.</span> <span class="toc-text">整数溢出</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#沙盒逃逸"><span class="toc-number">8.</span> <span class="toc-text">沙盒逃逸</span></a></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/img/post.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">0bs3rver的小屋</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">linux-pwn技能树</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-12-03 21:38:33"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-12-03</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-12-10 18:35:38"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-12-10</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/pwn/">pwn</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">3.2k</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><p>最近发现对过往的知识掌握还不够，所以打算建一个自己的技能树，以此来记录自己掌握的技术，也便于发现不足。</p>
<p>参考资料：<a href="https://ctf-wiki.github.io/ctf-wiki/pwn/readme-zh/" target="_blank" rel="noopener">ctf-wiki-pwn</a></p>
<p><strong>二进制漏洞利用的过程，就是一步步扩大可以控制的内存的范围</strong>。</p>
<h2 id="保护机制"><a href="#保护机制" class="headerlink" title="保护机制"></a>保护机制</h2><p>需要重点关注的是canary，其他的保护如下：</p>
<ul>
<li>FORTIFY保护：限制格式化字串漏洞</li>
<li>NX保护：堆栈不可执行</li>
<li>PIE保护：地址随机化</li>
<li>RELRO保护：GOT表不可写</li>
<li>去除符号表（stripped）：增加逆向难度</li>
</ul>
<h3 id="canary保护"><a href="#canary保护" class="headerlink" title="canary保护"></a>canary保护</h3><p>用于防止栈溢出被利用的一种方法，原理是在栈的ebp下面放一个随机数，在函数返回之前会检查这个数有没有被修改，就可以检测是否发生栈溢出了。</p>
<h4 id="泄漏栈中的canary"><a href="#泄漏栈中的canary" class="headerlink" title="泄漏栈中的canary"></a>泄漏栈中的canary</h4><p>Canary 设计为以字节 <code>\x00</code> 结尾，本意是为了保证 Canary 可以截断字符串。 泄露栈中的 Canary 的思路是覆盖 Canary 的低字节，来打印出剩余的 Canary 部分。</p>
<p>需要存在合适的输入函数例如read()，不会在后面加截断符</p>
<h4 id="绕过canary"><a href="#绕过canary" class="headerlink" title="绕过canary"></a>绕过canary</h4><p>不修改canary而完成栈溢出，例如scanf把某些输入（+、-）认定为无效而不是非法，从而不修改canary而完成栈溢出</p>
<p><a href="http://0bs3rver.space/2020/10/29/pwnable-tw-dubblesort-%E4%BF%9D%E6%8A%A4%E5%85%A8%E5%BC%80%E6%A0%88%E6%BA%A2%E5%87%BA/#%E5%88%A9%E7%94%A8" target="_blank" rel="noopener">pwnable-tw-dubblesort-保护全开栈溢出/#利用</a></p>
<h4 id="one-by-one-爆破-Canary"><a href="#one-by-one-爆破-Canary" class="headerlink" title="one-by-one 爆破 Canary"></a>one-by-one 爆破 Canary</h4><p>对于 Canary，虽然每次进程重启后的 Canary 不同 (相比 GS，GS 重启后是相同的)，但是同一个进程中的不同线程的 Canary 是相同的， 并且 通过 fork 函数创建的子进程的 Canary 也是相同的，因为 fork 函数会直接拷贝父进程的内存。</p>
<p>canary的最低位为0x00，之后逐次爆破，如果canary爆破不成功，则程序崩溃；爆破成功则程序进行下面的逻辑。由此可判断爆破是否成功。</p>
<p>我们可以利用这样的特点，彻底逐个字节将Canary爆破出来。</p>
<h4 id="劫持-stack-chk-fail-函数"><a href="#劫持-stack-chk-fail-函数" class="headerlink" title="劫持__stack_chk_fail 函数"></a>劫持__stack_chk_fail 函数</h4><p>已知 Canary 失败的处理逻辑会进入到 <code>__stack_chk_fail</code> 函数，<code>__stack_chk_fail</code> 函数是一个普通的延迟绑定函数，可以通过修改 GOT 表劫持这个函数。</p>
<h4 id="覆盖-TLS-中储存的-Canary-值"><a href="#覆盖-TLS-中储存的-Canary-值" class="headerlink" title="覆盖 TLS 中储存的 Canary 值"></a>覆盖 TLS 中储存的 Canary 值</h4><p>已知 Canary 储存在 TLS 中，在函数返回前会使用这个值进行对比。当溢出尺寸较大时，可以同时覆盖栈上储存的 Canary 和 TLS 储存的 Canary 实现绕过。</p>
<p>参考：<a href="https://jontsang.github.io/post/34550.html" target="_blank" rel="noopener">Bypassing Canary——Override Canary in TLS</a></p>
<h2 id="栈溢出"><a href="#栈溢出" class="headerlink" title="栈溢出"></a>栈溢出</h2><h3 id="初级ROP"><a href="#初级ROP" class="headerlink" title="初级ROP"></a>初级ROP</h3><p>ROP(Return Oriented Programming)，其主要思想是在<strong>栈缓冲区溢出的基础上，利用程序中已有的小片段 (gadgets) 来改变某些寄存器或者变量的值，从而控制程序的执行流程。</strong>所谓 gadgets 就是以 ret 结尾的指令序列，通过这些指令序列，我们可以修改某些地址的内容，方便控制程序的执行流程。</p>
<h4 id="ret2text"><a href="#ret2text" class="headerlink" title="ret2text"></a>ret2text</h4><p>ret2text 即控制程序执行程序本身已有的的代码 (.text)，例如存在后门函数等情况。</p>
<h4 id="ret2shellcode"><a href="#ret2shellcode" class="headerlink" title="ret2shellcode"></a>ret2shellcode</h4><p>ret2shellcode，即控制程序执行 shellcode 代码。shellcode 指的是用于完成某个功能的汇编代码，常见的功能主要是获取目标系统的 shell。<strong>一般来说，shellcode 需要我们自己填充。这其实是另外一种典型的利用方法，即此时我们需要自己去填充一些可执行的代码</strong>。</p>
<p>我的WP：<a href="http://0bs3rver.space/2020/11/28/pwnable-tw-death-note-%E5%8F%AF%E8%A7%81%E5%AD%97%E7%AC%A6shellcode/" target="_blank" rel="noopener">pwnable-tw-death-note-可见字符shellcode</a></p>
<h4 id="ret2syscall"><a href="#ret2syscall" class="headerlink" title="ret2syscall"></a>ret2syscall</h4><p>ret2syscall，即控制程序执行系统调用，获取 shell。</p>
<p>例如我们利用如下系统调用来获取 shell</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execve(<span class="string">"/bin/sh"</span>,<span class="literal">NULL</span>,<span class="literal">NULL</span>)</span><br></pre></td></tr></table></figure>

<p>其中，该程序是 32 位，所以我们需要使得</p>
<ul>
<li>系统调用号，即 eax 应该为 0xb</li>
<li>第一个参数，即 ebx 应该指向 /bin/sh 的地址，其实执行 sh 的地址也可以。</li>
<li>第二个参数，即 ecx 应该为 0</li>
<li>第三个参数，即 edx 应该为 0</li>
</ul>
<p>我们使用各种gadgets即可</p>
<h4 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h4><p>ret2libc 即控制函数的执行 libc 中的函数，通常是返回至某个函数的 plt 处或者函数的具体位置 (即函数对应的 got 表项的内容)。一般情况下，我们会选择执行 system(“/bin/sh”)，故而此时我们需要知道 system 函数的地址。</p>
<p>再就是one_gadget，应该也可以算做这类利用</p>
<h3 id="中级ROP"><a href="#中级ROP" class="headerlink" title="中级ROP"></a>中级ROP</h3><p>中级 ROP 主要是使用了一些比较巧妙的 Gadgets。</p>
<h4 id="ret2csu"><a href="#ret2csu" class="headerlink" title="ret2csu"></a>ret2csu</h4><p>在 64 位程序中，函数的前 6 个参数是通过寄存器传递的，但是大多数时候，我们很难找到每一个寄存器对应的 gadgets。 这时候，我们可以利用 x64 下的 __libc_csu_init 中的 gadgets。这个函数是用来对 libc 进行初始化操作的，而一般的程序都会调用 libc 函数，所以这个函数一定会存在。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005</span>C0 ; <span class="keyword">void</span> _libc_csu_init(<span class="keyword">void</span>)</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005</span>C0                 <span class="keyword">public</span> __libc_csu_init</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005</span>C0 __libc_csu_init proc near               ; DATA XREF: _start+<span class="number">16</span>o</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005</span>C0                 push    r15</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005</span>C2                 push    r14</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005</span>C4                 mov     r15d, edi</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005</span>C7                 push    r13</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005</span>C9                 push    r12</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005</span>CB                 lea     r12, __frame_dummy_init_array_entry</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005</span>D2                 push    rbp</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005</span>D3                 lea     rbp, __do_global_dtors_aux_fini_array_entry</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005</span>DA                 push    rbx</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005</span>DB                 mov     r14, rsi</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005</span>DE                 mov     r13, rdx</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005E1</span>                 sub     rbp, r12</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005E4</span>                 sub     rsp, <span class="number">8</span></span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005E8</span>                 sar     rbp, <span class="number">3</span></span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005</span>EC                 call    _init_proc</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005F</span>1                 test    rbp, rbp</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005F</span>4                 jz      short loc_400616</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005F</span>6                 <span class="keyword">xor</span>     ebx, ebx</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">00000000004005F</span>8                 nop     dword ptr [rax+rax+<span class="number">00000000</span>h]</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">0000000000400600</span></span><br><span class="line">.<span class="built_in">text</span>:<span class="number">0000000000400600</span> loc_400600:                             ; CODE XREF: __libc_csu_init+<span class="number">54</span>j</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">0000000000400600</span>                 mov     rdx, r13</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">0000000000400603</span>                 mov     rsi, r14</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">0000000000400606</span>                 mov     edi, r15d</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">0000000000400609</span>                 call    qword ptr [r12+rbx*<span class="number">8</span>]</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">000000000040060</span>D                 add     rbx, <span class="number">1</span></span><br><span class="line">.<span class="built_in">text</span>:<span class="number">0000000000400611</span>                 cmp     rbx, rbp</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">0000000000400614</span>                 jnz     short loc_400600</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">0000000000400616</span></span><br><span class="line">.<span class="built_in">text</span>:<span class="number">0000000000400616</span> loc_400616:                             ; CODE XREF: __libc_csu_init+<span class="number">34</span>j</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">0000000000400616</span>                 add     rsp, <span class="number">8</span></span><br><span class="line">.<span class="built_in">text</span>:<span class="number">000000000040061</span>A                 pop     rbx</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">000000000040061B</span>                 pop     rbp</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">000000000040061</span>C                 pop     r12</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">000000000040061</span>E                 pop     r13</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">0000000000400620</span>                 pop     r14</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">0000000000400622</span>                 pop     r15</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">0000000000400624</span>                 retn</span><br><span class="line">.<span class="built_in">text</span>:<span class="number">0000000000400624</span> __libc_csu_init endp</span><br></pre></td></tr></table></figure>

<p>这里我们可以利用以下几点</p>
<ul>
<li>从 0x000000000040061A 一直到结尾，我们可以利用栈溢出构造栈上数据来控制 rbx,rbp,r12,r13,r14,r15 寄存器的数据。</li>
<li>从 0x0000000000400600 到 0x0000000000400609，我们可以将 r13 赋给 rdx, 将 r14 赋给 rsi，将 r15d 赋给 edi（需要注意的是，虽然这里赋给的是 edi，<strong>但其实此时 rdi 的高 32 位寄存器值为 0（自行调试）</strong>，所以其实我们可以控制 rdi 寄存器的值，只不过只能控制低 32 位），而这三个寄存器，也是 x64 函数调用中传递的前三个寄存器。此外，如果我们可以合理地控制 r12 与 rbx，那么我们就可以调用我们想要调用的函数。比如说我们可以控制 rbx 为 0，r12 为存储我们想要调用的函数的地址。</li>
<li>从 0x000000000040060D 到 0x0000000000400614，我们可以控制 rbx 与 rbp 的之间的关系为 rbx+1 = rbp，这样我们就不会执行 loc_400600，进而可以继续执行下面的汇编程序。这里我们可以简单的设置 rbx=0，rbp=1。</li>
</ul>
<h4 id="ret2reg"><a href="#ret2reg" class="headerlink" title="ret2reg"></a>ret2reg</h4><p>还没写过题目，仅在此记录原理</p>
<ol>
<li>查看溢出函返回时哪个寄存值指向溢出缓冲区空间</li>
<li>然后反编译二进制，查找 call reg 或者 jmp reg 指令，将 EIP 设置为该指令地址</li>
<li>reg 所指向的空间上注入 Shellcode (需要确保该空间是可以执行的，但通常都是栈上的)</li>
</ol>
<h4 id="BROP"><a href="#BROP" class="headerlink" title="BROP"></a>BROP</h4><p>Blind ROP，简而言之就是没有对应应用程序的源代码或者二进制文件下，对程序进行攻击，劫持程序的执行流。</p>
<p>也还没写过这类题目</p>
<p>参考<a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/medium-rop-zh/#brop" target="_blank" rel="noopener">ctf-wiki-BROP</a></p>
<h3 id="高级ROP"><a href="#高级ROP" class="headerlink" title="高级ROP"></a>高级ROP</h3><h4 id="ret2-dl-runtime-resolve"><a href="#ret2-dl-runtime-resolve" class="headerlink" title="ret2_dl_runtime_resolve"></a>ret2_dl_runtime_resolve</h4><p>在 linux 中是利用_dl_runtime_resolve(link_map_obj, reloc_index) 来对动态链接的函数进行重定位的。如果我们可以控制相应的参数以及其对应地址的内容就可以控制解析的函数了。</p>
<p>还没写过这类题目</p>
<p>参考<a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/advanced-rop-zh/#ret2_dl_runtime_resolve" target="_blank" rel="noopener">ctf-wiki-ret2_dl_runtime_resolve</a></p>
<h4 id="SROP"><a href="#SROP" class="headerlink" title="SROP"></a>SROP</h4><p>简而言之就是通过<code>sigreturn</code>这个系统调用来控制各寄存器的值</p>
<p>还没写过这类题目</p>
<p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/advanced-rop-zh/#srop" target="_blank" rel="noopener">ctf-wiki-SROP</a></p>
<h3 id="Stack-smash"><a href="#Stack-smash" class="headerlink" title="Stack smash"></a>Stack smash</h3><p>在程序加了 canary 保护之后，如果我们读取的 buffer 覆盖了对应的值时，程序就会报错，而一般来说我们并不会关心报错信息。而 stack smash 技巧则就是利用打印这一信息的程序来得到我们想要的内容。这是因为在程序启动 canary 保护之后，如果发现 canary 被修改的话，程序就会执行 <code>__stack_chk_fail</code> 函数来打印 argv[0] 指针所指向的字符串，正常情况下，这个指针指向了程序名。</p>
<p>如果我们利用栈溢出覆盖 argv[0] 为我们想要输出的字符串的地址，那么在 <code>__fortify_fail</code> 函数中就会输出我们想要的信息。</p>
<h3 id="栈上的-partial-overwrite"><a href="#栈上的-partial-overwrite" class="headerlink" title="栈上的 partial overwrite"></a>栈上的 partial overwrite</h3><p>我们知道, 在开启了随机化（ASLR，PIE）后, 无论高位的地址如何变化，低 12 位的页内偏移始终是固定的, 也就是说如果我们能更改低位的偏移, 就可以在一定程度上控制程序的执行流, 绕过 PIE 保护。</p>
<h3 id="栈迁移"><a href="#栈迁移" class="headerlink" title="栈迁移"></a>栈迁移</h3><p>栈迁移一般是ROP利用的前序步骤，目标是劫持esp寄存器到我们控制的内存上去，然后在ret的时候就可以进入我们布置好的ROP链</p>
<p>例如：<a href="http://0bs3rver.space/2020/10/27/pwnable-tw-3x17-%E4%BB%BB%E6%84%8F%E5%9C%B0%E5%9D%80%E5%86%99%E6%9E%84%E9%80%A0ROP/" target="_blank" rel="noopener">pwnable-tw-3x17-任意地址写构造ROP</a></p>
<h2 id="格式化字符串"><a href="#格式化字符串" class="headerlink" title="格式化字符串"></a>格式化字符串</h2><h3 id="printf"><a href="#printf" class="headerlink" title="printf"></a>printf</h3><p>最核心的利用：</p>
<ol>
<li>利用%p进行参数打印，用于实现任意内存泄漏</li>
<li>利用%n进行内存修改，利用%$n/hn/hhn可以将内存值修改为之前打印的字符数目</li>
</ol>
<p><a href="https://blog.csdn.net/weixin_43742794/article/details/98640383" target="_blank" rel="noopener">64位格式化字符串和栈溢出</a></p>
<h3 id="sprintf"><a href="#sprintf" class="headerlink" title="sprintf"></a>sprintf</h3><p>函数作用是字符串复制，我们可以利用字符串可变进行越界，类似于栈溢出</p>
<p><a href="http://0bs3rver.space/2020/12/02/pwnable-tw-spirited-away-read%E4%B8%8Esprintf%E7%9A%84%E6%A0%88%E6%BA%A2%E5%87%BA/" target="_blank" rel="noopener">pwnable.tw-spirited_away-read与sprintf的栈溢出</a></p>
<h3 id="strcpy"><a href="#strcpy" class="headerlink" title="strcpy"></a>strcpy</h3><p>利用字符串复制的截断造成复制意料之外的数据</p>
<p><a href="http://0bs3rver.space/2020/12/04/pwnable-tw-babystack-strcpy%E5%BD%A2%E6%88%90%E6%A0%88%E6%BA%A2%E5%87%BA/" target="_blank" rel="noopener">pwnable-tw-babystack-strcpy形成栈溢出</a></p>
<h2 id="堆利用"><a href="#堆利用" class="headerlink" title="堆利用"></a>堆利用</h2><p>据说，堆利用的本质就是UAF</p>
<h3 id="off-by-one"><a href="#off-by-one" class="headerlink" title="off-by-one"></a>off-by-one</h3><p>off-by-one 是指单字节缓冲区溢出，利用：</p>
<ol>
<li>溢出字节为可控制任意字节：通过修改大小造成块结构之间出现重叠，从而泄露其他块数据，或是覆盖其他块数据。也可使用 NULL 字节溢出的方法</li>
<li>溢出字节为 NULL 字节：在 size 为 0x100 的时候，溢出 NULL 字节可以使得 <code>prev_in_use</code> 位被清，这样前块会被认为是 free 块。</li>
</ol>
<h3 id="chunk-extend"><a href="#chunk-extend" class="headerlink" title="chunk extend"></a>chunk extend</h3><p>简而言之，就是通过控制chunk header 中的数据，完成对其他堆内容的控制</p>
<p>在ptmalloc中，获取后一堆块的地址是使用当前块指针加上当前块大小，获取前一堆块的地址是通过 malloc_chunk-&gt;prev_size 获取前一块大小，然后使用本 chunk 地址减去所得大小，而判断当前chunk是否是use状态的操作是查看下一 chunk 的 prev_inuse 域。</p>
<h3 id="unlink"><a href="#unlink" class="headerlink" title="unlink"></a>unlink</h3><p>在利用 unlink 所造成的漏洞时，其实就是对 chunk 进行内存布局，然后借助 unlink 操作来达成修改指针的效果。</p>
<p>类似unlink的利用：<a href="http://0bs3rver.space/2020/11/16/pwnable-tw-applestore-%E5%88%A9%E7%94%A8%E6%A0%88%E5%B9%B3%E8%A1%A1%E6%8E%A7%E5%88%B6%E5%86%85%E5%AD%98/#delete%E4%B8%80%E6%AC%A1%E6%9C%89%E7%BA%A6%E6%9D%9F%E7%9A%84%E5%9C%B0%E5%9D%80%E5%86%99" target="_blank" rel="noopener">pwnable-tw-applestore-利用栈平衡控制内存/#delete一次有约束的地址写</a></p>
<h3 id="UAF"><a href="#UAF" class="headerlink" title="UAF"></a>UAF</h3><p>use after free 顾名思义，就是一个内存块被释放之后我们还是可以使用它</p>
<p><a href="http://0bs3rver.space/2020/11/21/pwnable-tw-re-alloc-%E5%88%A9%E7%94%A8realloc%E5%AE%9E%E7%8E%B0uaf%E6%9B%B4%E6%94%B9got%E8%A1%A8/" target="_blank" rel="noopener">pwnable-tw-re-alloc-利用realloc实现uaf更改got表</a></p>
<h3 id="fastbin-attack"><a href="#fastbin-attack" class="headerlink" title="fastbin-attack"></a>fastbin-attack</h3><h4 id="house-of-spirit"><a href="#house-of-spirit" class="headerlink" title="house-of-spirit"></a>house-of-spirit</h4><p>house of spirit 技术的核心原理是在目标位置处伪造一个chunk，并将其释放，从而达到分配<strong>指定地址</strong>的chunk的目的，<strong>成功的关键是要能够修改指定地址的前后的内容使其可以绕过对应的检测</strong></p>
<p><a href="http://0bs3rver.space/2020/11/26/pwnable-tw-TcacheTear-tcache-dupANDhouse-of-spiritAND-free-hook/#house-of-spirit" target="_blank" rel="noopener">pwnable-tw-TcacheTear-tcache-dupANDhouse-of-spiritAND-free-hook</a></p>
<h4 id="arbitrary-alloc"><a href="#arbitrary-alloc" class="headerlink" title="arbitrary-alloc"></a>arbitrary-alloc</h4><p>通过寻找合适的值完成任意地址分配</p>
<p><a href="http://0bs3rver.space/2020/12/07/pwnable-tw-secret-garden-fastbin%E4%BB%BB%E6%84%8F%E5%9C%B0%E5%9D%80%E5%88%86%E9%85%8D%E4%BF%AE%E6%94%B9hook/" target="_blank" rel="noopener">pwnable-tw-secret-garden-fastbin任意地址分配修改hook</a></p>
<h3 id="unsortedbin-attack"><a href="#unsortedbin-attack" class="headerlink" title="unsortedbin-attack"></a>unsortedbin-attack</h3><h4 id="main-arena泄漏libc基址"><a href="#main-arena泄漏libc基址" class="headerlink" title="main-arena泄漏libc基址"></a>main-arena泄漏libc基址</h4><p><a href="http://0bs3rver.space/2020/11/02/pwnable-tw-hacknote-%E7%94%A8main-arena%E6%B3%84%E6%BC%8Flibc/#unsortbin%E6%B3%84%E9%9C%B2libc%E5%9F%BA%E5%9D%80" target="_blank" rel="noopener">pwnable-tw-hacknote-用main-arena泄漏libc/#unsortbin泄露libc基址</a></p>
<h3 id="tcache-attack"><a href="#tcache-attack" class="headerlink" title="tcache-attack"></a>tcache-attack</h3><h4 id="tcache-dup"><a href="#tcache-dup" class="headerlink" title="tcache-dup"></a>tcache-dup</h4><p>类似于简易版double free</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="built_in">malloc</span>(<span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">free</span>(a);</span><br><span class="line"><span class="built_in">free</span>(a);</span><br><span class="line"></span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x20</span>,addr)</span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x20</span>)</span><br><span class="line"><span class="built_in">malloc</span>(<span class="number">0x20</span>,data)</span><br></pre></td></tr></table></figure>

<p><a href="http://0bs3rver.space/2020/11/26/pwnable-tw-TcacheTear-tcache-dupANDhouse-of-spiritAND-free-hook/#tcache-dup%E6%9E%84%E9%80%A0%E4%BB%BB%E6%84%8F%E5%9C%B0%E5%9D%80%E5%86%99" target="_blank" rel="noopener">pwnable-tw-TcacheTear-tcache-dupANDhouse-of-spiritAND-free-hook/#tcache-dup构造任意地址写</a></p>
<h3 id="glibc2-29-key指针"><a href="#glibc2-29-key指针" class="headerlink" title="glibc2.29-key指针"></a>glibc2.29-key指针</h3><p>glibc2.29引入的key指针，它指向堆开头的tcache_perthread_struct结构的地址，我们将他泄漏就可以得到堆基址。</p>
<p><a href="https://github.com/0bs3rver/learning-with-sakura/tree/master/ctf/googlectf_echo" target="_blank" rel="noopener">googlectf_echo</a></p>
<h2 id="IO-FILE"><a href="#IO-FILE" class="headerlink" title="IO FILE"></a>IO FILE</h2><p>libc实现的文件流机制中存在可以被改写的函数指针</p>
<h3 id="glibc2-23下伪造vtable"><a href="#glibc2-23下伪造vtable" class="headerlink" title="glibc2.23下伪造vtable"></a>glibc2.23下伪造vtable</h3><p>伪造 vtable 劫持程序流程的中心思想就是针对_IO_FILE_plus 的 vtable 动手脚，通过把 vtable 指向我们控制的内存，并在其中布置函数指针来实现。</p>
<p><a href="http://0bs3rver.space/2020/11/28/pwnable-tw-seethefile-%E6%A0%88%E6%BA%A2%E5%87%BA%E6%9E%84%E9%80%A0fake-FILE/#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%E4%B9%8B-IO-FILE" target="_blank" rel="noopener">pwnable-tw-seethefile-栈溢出构造fake-FILE/#前置知识之-IO-FILE</a></p>
<h2 id="逻辑漏洞"><a href="#逻辑漏洞" class="headerlink" title="逻辑漏洞"></a>逻辑漏洞</h2><p>简而言之就是程序逻辑不完善造成的意外情况</p>
<p><a href="http://0bs3rver.space/2020/10/23/pwnable-tw-calc-%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E%E5%AE%9E%E7%8E%B0%E4%BB%BB%E6%84%8F%E5%9C%B0%E5%9D%80%E8%AF%BB%E5%86%99/" target="_blank" rel="noopener">pwnable-tw-calc-逻辑漏洞实现任意地址读写</a></p>
<h2 id="整数溢出"><a href="#整数溢出" class="headerlink" title="整数溢出"></a>整数溢出</h2><p>主要是类型转换，上下界溢出等情况</p>
<p><a href="https://github.com/0bs3rver/learning-with-sakura/tree/master/kernel/%E6%80%9D%E8%80%83%E9%A2%98-10%E7%A7%8D%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA%E5%92%8C%E6%B5%AE%E7%82%B9%E7%B2%BE%E5%BA%A6%E5%AF%BC%E8%87%B4%E7%9A%84%E6%BC%8F%E6%B4%9E" target="_blank" rel="noopener">10种整数溢出和浮点精度导致的漏洞</a></p>
<h2 id="沙盒逃逸"><a href="#沙盒逃逸" class="headerlink" title="沙盒逃逸"></a>沙盒逃逸</h2><p>我的理解就是在各种限制下完成shell的获取</p>
<p><a href="https://github.com/0bs3rver/learning-with-sakura/tree/master/ctf/plaidctf2020_sandybox" target="_blank" rel="noopener">plaidctf2020_sandybox</a></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">0bs3rver</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2020/12/03/linux-pwn%E6%8A%80%E8%83%BD%E6%A0%91/">http://yoursite.com/2020/12/03/linux-pwn%E6%8A%80%E8%83%BD%E6%A0%91/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com" target="_blank">0bs3rver的小屋</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/pwn/">pwn</a></div><div class="post_share"><div class="social-share" data-image="/img/post.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/12/04/pwnable-tw-babystack-strcpy%E5%BD%A2%E6%88%90%E6%A0%88%E6%BA%A2%E5%87%BA/"><img class="prev_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">pwnable.tw-babystack-strcpy形成栈溢出</div></div></a></div><div class="next-post pull_right"><a href="/2020/12/02/pwnable-tw-spirited-away-read%E4%B8%8Esprintf%E7%9A%84%E6%A0%88%E6%BA%A2%E5%87%BA/"><img class="next_cover lazyload" data-src="/img/post.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">pwnable.tw-spirited_away-read与sprintf的栈溢出</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/11/16/CVE-2017-17215-华为HG532命令注入漏洞分析/" title="CVE-2017-17215-华为HG532命令注入漏洞分析"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-11-16</div><div class="relatedPosts_title">CVE-2017-17215-华为HG532命令注入漏洞分析</div></div></a></div><div class="relatedPosts_item"><a href="/2020/04/18/GUESS-fork相关/" title="GUESS-fork相关"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-04-18</div><div class="relatedPosts_title">GUESS-fork相关</div></div></a></div><div class="relatedPosts_item"><a href="/2020/10/27/pwnable-tw-3x17-任意地址写构造ROP/" title="pwnable.tw-3x17-任意地址写构造ROP"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-10-27</div><div class="relatedPosts_title">pwnable.tw-3x17-任意地址写构造ROP</div></div></a></div><div class="relatedPosts_item"><a href="/2020/11/26/pwnable-tw-TcacheTear-tcache-dupANDhouse-of-spiritAND-free-hook/" title="pwnable.tw-TcacheTear-tcache-dupANDhouse-of-spiritAND__free_hook"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-11-26</div><div class="relatedPosts_title">pwnable.tw-TcacheTear-tcache-dupANDhouse-of-spiritAND__free_hook</div></div></a></div><div class="relatedPosts_item"><a href="/2021/01/14/pwnable-tw-alive-note-构造分段shellcode/" title="pwnable.tw-alive_note-构造分段shellcode"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-01-14</div><div class="relatedPosts_title">pwnable.tw-alive_note-构造分段shellcode</div></div></a></div><div class="relatedPosts_item"><a href="/2020/12/04/pwnable-tw-babystack-strcpy形成栈溢出/" title="pwnable.tw-babystack-strcpy形成栈溢出"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-12-04</div><div class="relatedPosts_title">pwnable.tw-babystack-strcpy形成栈溢出</div></div></a></div></div><div class="clear_both"></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By 0bs3rver</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="/js/search/local-search.js"></script></body></html>